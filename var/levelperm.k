level:{
 {x{
  (r;q):y;
  i:+\x=0N;
  n:i@(#i)-1;
  k:i?1+n!$[r=0; q; q+1];
  x[k]:(#x)-n; x}/y}[x#0N]'++'2#'1_x{
  k:x[0];
  (t;n;j):x[1 2 3];
  m:*/1+!n-j;
  (m!k;`i$k%m;n;j+1)}\(!*/1+!x;0;x;1)}
level 3
(0 1 2
 2 0 1
 1 0 2
 2 1 0
 1 2 0
 0 2 1)
